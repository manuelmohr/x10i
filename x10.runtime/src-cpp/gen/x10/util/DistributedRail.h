#ifndef __X10_UTIL_DISTRIBUTEDRAIL_H
#define __X10_UTIL_DISTRIBUTEDRAIL_H

#include <x10rt.h>


#define X10_LANG_OBJECT_H_NODEPS
#include <x10/lang/Object.h>
#undef X10_LANG_OBJECT_H_NODEPS
#define X10_LANG_SETTABLE_H_NODEPS
#include <x10/lang/Settable.h>
#undef X10_LANG_SETTABLE_H_NODEPS
#define X10_LANG_ITERABLE_H_NODEPS
#include <x10/lang/Iterable.h>
#undef X10_LANG_ITERABLE_H_NODEPS
#define X10_LANG_PLACELOCALHANDLE_STRUCT_H_NODEPS
#include <x10/lang/PlaceLocalHandle.struct_h>
#undef X10_LANG_PLACELOCALHANDLE_STRUCT_H_NODEPS
#define X10_LANG_PLACE_STRUCT_H_NODEPS
#include <x10/lang/Place.struct_h>
#undef X10_LANG_PLACE_STRUCT_H_NODEPS
#define X10_LANG_PLACELOCALHANDLE_STRUCT_H_NODEPS
#include <x10/lang/PlaceLocalHandle.struct_h>
#undef X10_LANG_PLACELOCALHANDLE_STRUCT_H_NODEPS
#define X10_LANG_INT_STRUCT_H_NODEPS
#include <x10/lang/Int.struct_h>
#undef X10_LANG_INT_STRUCT_H_NODEPS
#define X10_LANG_PLACELOCALHANDLE_STRUCT_H_NODEPS
#include <x10/lang/PlaceLocalHandle.struct_h>
#undef X10_LANG_PLACELOCALHANDLE_STRUCT_H_NODEPS
namespace x10 { namespace lang { 
class Int;
} } 
#include <x10/lang/Int.struct_h>
namespace x10 { namespace lang { 
template<class FMGL(T)> class PlaceLocalHandle;
} } 
#include <x10/lang/PlaceLocalHandle.struct_h>
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace lang { 
class Place;
} } 
#include <x10/lang/Place.struct_h>
namespace x10 { namespace lang { 
template<class FMGL(T)> class PlaceLocalHandle;
} } 
#include <x10/lang/PlaceLocalHandle.struct_h>
namespace x10 { namespace util { 
template<class FMGL(K), class FMGL(V)> class HashMap;
} } 
namespace x10 { namespace lang { 
class Activity;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class ValRail;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class PlaceLocalHandle;
} } 
#include <x10/lang/PlaceLocalHandle.struct_h>
namespace x10 { namespace lang { 
template<class FMGL(T)> class Cell;
} } 
namespace x10 { namespace lang { 
class Boolean;
} } 
#include <x10/lang/Boolean.struct_h>
namespace x10 { namespace lang { 
template<class FMGL(T)> class PlaceLocalHandle;
} } 
#include <x10/lang/PlaceLocalHandle.struct_h>
namespace x10 { namespace util { 
template<class FMGL(K), class FMGL(V)> class HashMap;
} } 
namespace x10 { namespace array { 
class Dist;
} } 
namespace x10 { namespace lang { 
template<class FMGL(U)> class Fun_0_0;
} } 
namespace x10 { namespace lang { 
template<class FMGL(U)> class Fun_0_0;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class ValRail;
} } 
namespace x10 { namespace lang { 
template<class FMGL(U)> class Fun_0_0;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace lang { 
class Runtime;
} } 
namespace x10 { namespace lang { 
template<class FMGL(Z1), class FMGL(U)> class Fun_0_1;
} } 
namespace x10 { namespace lang { 
template<class FMGL(U)> class Fun_0_0;
} } 
namespace x10 { namespace lang { 
template<class FMGL(U)> class Fun_0_0;
} } 
namespace x10 { namespace lang { 
template<class FMGL(U)> class Fun_0_0;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class ValRail;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class ValRail;
} } 
namespace x10 { namespace lang { 
template<class FMGL(Z1), class FMGL(U)> class Fun_0_1;
} } 
namespace x10 { namespace lang { 
class ClassCastException;
} } 
namespace x10 { namespace lang { 
class VoidFun_0_0;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Iterator;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Iterator;
} } 
namespace x10 { namespace lang { 
template<class FMGL(U)> class Fun_0_0;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Iterator;
} } 
namespace x10 { namespace lang { 
template<class FMGL(Z1), class FMGL(Z2), class FMGL(U)> class Fun_0_2;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Iterator;
} } 
namespace x10 { namespace util { 
template<class FMGL(Key), class FMGL(Val)> class Map__Entry;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace util { 
template<class FMGL(Key), class FMGL(Val)> class Map__Entry;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace lang { 
template<class FMGL(U)> class Fun_0_0;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace lang { 
class Throwable;
} } 
namespace x10 { namespace lang { 
template<class FMGL(U)> class Fun_0_0;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace lang { 
template<class FMGL(U)> class Fun_0_0;
} } 
namespace x10 { namespace util { 
template<class FMGL(T), class FMGL(U)> class Pair;
} } 
#include <x10/util/Pair.struct_h>
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace util { 
template<class FMGL(T), class FMGL(U)> class Pair;
} } 
#include <x10/util/Pair.struct_h>
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace util { 
template<class FMGL(T), class FMGL(U)> class Pair;
} } 
#include <x10/util/Pair.struct_h>
namespace x10 { namespace lang { 
template<class FMGL(T)> class Iterator;
} } 
namespace x10 { namespace util { 
template<class FMGL(Key), class FMGL(Val)> class Map__Entry;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace util { 
template<class FMGL(Key), class FMGL(Val)> class Map__Entry;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace lang { 
template<class FMGL(U)> class Fun_0_0;
} } 
namespace x10 { namespace lang { 
template<class FMGL(T)> class Rail;
} } 
namespace x10 { namespace util { 

template<class FMGL(T)> class DistributedRail;
template <> class DistributedRail<void>;
template<class FMGL(T)> class DistributedRail : public x10::lang::Object 
 {
    public:
    RTT_H_DECLS_CLASS
    
    static x10aux::itable_entry _itables[4];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    static typename x10::lang::Settable<x10_int, FMGL(T)>::template itable<x10::util::DistributedRail<FMGL(T)> > _itable_0;
    
    static x10::lang::Any::itable<x10::util::DistributedRail<FMGL(T)> > _itable_1;
    
    static typename x10::lang::Iterable<FMGL(T)>::template itable<x10::util::DistributedRail<FMGL(T)> > _itable_2;
    
    void _instance_init();
    
    x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Rail<FMGL(T) > > >
      FMGL(data);
    
    x10::lang::Place
      FMGL(firstPlace);
    
    x10::lang::PlaceLocalHandle<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >
      FMGL(localRails);
    
    x10aux::ref<x10::lang::ValRail<FMGL(T) > >
      FMGL(original);
    
    x10_int
      FMGL(original_len);
    
    x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Cell<x10_boolean> > >
      FMGL(done);
    
    void _constructor(
      x10_int len,
      x10aux::ref<x10::lang::ValRail<FMGL(T) > > init);
    
    static x10aux::ref<x10::util::DistributedRail<FMGL(T)> > _make(
             x10_int len,
             x10aux::ref<x10::lang::ValRail<FMGL(T) > > init);
    
    void _constructor(
      x10_int len,
      x10aux::ref<x10::lang::Fun_0_1<x10_int, FMGL(T)> > init);
    
    static x10aux::ref<x10::util::DistributedRail<FMGL(T)> > _make(
             x10_int len,
             x10aux::ref<x10::lang::Fun_0_1<x10_int, FMGL(T)> > init);
    
    virtual x10aux::ref<x10::lang::Rail<FMGL(T) > >
      apply(
      );
    virtual x10aux::ref<x10::lang::Rail<FMGL(T) > >
      get(
      );
    virtual void
      drop(
      );
    virtual FMGL(T)
      apply(
      x10_int i);
    virtual FMGL(T)
      set(
      FMGL(T) v,
      x10_int i);
    virtual x10aux::ref<x10::lang::Iterator<FMGL(T)> >
      iterator(
      );
    void
      reduceLocal(
      x10aux::ref<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> > op);
    void
      reduceGlobal(
      x10aux::ref<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> > op);
    void
      bcastLocal(
      x10aux::ref<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> > op);
    virtual void
      collectiveReduce(
      x10aux::ref<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> > op);
    
    // Serialization
    public: static const x10aux::serialization_id_t _serialization_id;
    
    public: static void _serialize(x10aux::ref<x10::util::DistributedRail<FMGL(T)> > this_,
                                   x10aux::serialization_buffer& buf);
    
    public: x10aux::serialization_id_t _get_serialization_id() {
         return _serialization_id;
    }
    
    public: void _serialize_body(x10aux::serialization_buffer& buf);
    
    public: template<class __T> static x10aux::ref<__T> _deserializer(x10aux::deserialization_buffer& buf);
    
    public: template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer& buf);
    
    public: void _deserialize_body(x10aux::deserialization_buffer& buf);
    
};
template <> class DistributedRail<void> : public x10::lang::Object
{
    public:
    static x10aux::RuntimeType rtt;
    static const x10aux::RuntimeType* getRTT() { return & rtt; }
    template<class FMGL(S)>
    static x10aux::ref<x10::lang::ValRail<FMGL(S) > >
      __implicit_convert(
      x10aux::ref<x10::util::DistributedRail<FMGL(S)> > x);
    
    
};

} } 
#endif // X10_UTIL_DISTRIBUTEDRAIL_H

namespace x10 { namespace util { 
template<class FMGL(T)>
class DistributedRail;
} } 

#ifndef X10_UTIL_DISTRIBUTEDRAIL_H_NODEPS
#define X10_UTIL_DISTRIBUTEDRAIL_H_NODEPS
#include <x10/lang/Object.h>
#include <x10/lang/Settable.h>
#include <x10/lang/Iterable.h>
#include <x10/lang/Int.h>
#include <x10/lang/PlaceLocalHandle.h>
#include <x10/lang/Rail.h>
#include <x10/lang/Place.h>
#include <x10/lang/PlaceLocalHandle.h>
#include <x10/util/HashMap.h>
#include <x10/lang/Activity.h>
#include <x10/lang/Rail.h>
#include <x10/lang/ValRail.h>
#include <x10/lang/PlaceLocalHandle.h>
#include <x10/lang/Cell.h>
#include <x10/lang/Boolean.h>
#include <x10/lang/PlaceLocalHandle.h>
#include <x10/util/HashMap.h>
#include <x10/array/Dist.h>
#include <x10/lang/Fun_0_0.h>
#include <x10/lang/Fun_0_0.h>
#include <x10/lang/ValRail.h>
#include <x10/lang/Fun_0_0.h>
#include <x10/lang/Rail.h>
#include <x10/lang/Runtime.h>
#include <x10/lang/Fun_0_1.h>
#include <x10/lang/Fun_0_0.h>
#include <x10/lang/Fun_0_0.h>
#include <x10/lang/Fun_0_0.h>
#include <x10/lang/ValRail.h>
#include <x10/lang/ValRail.h>
#include <x10/lang/Fun_0_1.h>
#include <x10/lang/ClassCastException.h>
#include <x10/lang/VoidFun_0_0.h>
#include <x10/lang/Iterator.h>
#include <x10/lang/Iterator.h>
#include <x10/lang/Fun_0_0.h>
#include <x10/lang/Iterator.h>
#include <x10/lang/Fun_0_2.h>
#include <x10/lang/Iterator.h>
#include <x10/util/Map__Entry.h>
#include <x10/lang/Rail.h>
#include <x10/util/Map__Entry.h>
#include <x10/lang/Rail.h>
#include <x10/lang/Rail.h>
#include <x10/lang/Rail.h>
#include <x10/lang/Fun_0_0.h>
#include <x10/lang/Rail.h>
#include <x10/lang/Throwable.h>
#include <x10/lang/Fun_0_0.h>
#include <x10/lang/Rail.h>
#include <x10/lang/Fun_0_0.h>
#include <x10/util/Pair.h>
#include <x10/lang/Rail.h>
#include <x10/util/Pair.h>
#include <x10/lang/Rail.h>
#include <x10/util/Pair.h>
#include <x10/lang/Iterator.h>
#include <x10/util/Map__Entry.h>
#include <x10/lang/Rail.h>
#include <x10/util/Map__Entry.h>
#include <x10/lang/Rail.h>
#include <x10/lang/Rail.h>
#include <x10/lang/Rail.h>
#include <x10/lang/Fun_0_0.h>
#include <x10/lang/Rail.h>
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__14_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__14_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/VoidFun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__14 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::VoidFun_0_0::template itable <x10_util_DistributedRail__closure__14<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    void apply() {
        
        //#line 125 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        x10::lang::Rail__NativeRep::copyFrom(r,((x10_int)0),master,((x10_int)0),x10aux::nullCheck(r)->
                                                                                  FMGL(length));
    }
    
    // captured environment
    x10aux::ref<x10::lang::Rail<FMGL(T) > > r;
    x10aux::ref<x10::lang::Rail<FMGL(T) > > master;
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        buf.write(this->r);
        buf.write(this->master);
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10aux::ref<x10::lang::Rail<FMGL(T) > > that_r = buf.read<x10aux::ref<x10::lang::Rail<FMGL(T) > > >();
        x10aux::ref<x10::lang::Rail<FMGL(T) > > that_master = buf.read<x10aux::ref<x10::lang::Rail<FMGL(T) > > >();
        x10aux::ref<x10_util_DistributedRail__closure__14<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__14<FMGL(T) > >()) x10_util_DistributedRail__closure__14<FMGL(T) >(that_r, that_master);
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__14(x10aux::ref<x10::lang::Rail<FMGL(T) > > r, x10aux::ref<x10::lang::Rail<FMGL(T) > > master) : r(r), master(master) { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::VoidFun_0_0>(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::VoidFun_0_0>(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:125";
    }

};

template<class FMGL(T)> typename x10::lang::VoidFun_0_0::template itable <x10_util_DistributedRail__closure__14<FMGL(T) > >x10_util_DistributedRail__closure__14<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__14<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__14<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__14<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::VoidFun_0_0>, &x10_util_DistributedRail__closure__14<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__14<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__14<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__14_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__13_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__13_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/Fun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__13 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::template itable <x10_util_DistributedRail__closure__13<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    x10aux::ref<x10::lang::Rail<FMGL(T) > > apply() {
        
        //#line 124 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
        return (((x10::lang::Reference*)(((x10aux::ref<x10::lang::Reference>)x10aux::nullCheck(e)).operator->()))->*(x10aux::findITable<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(((x10aux::ref<x10::lang::Reference>)e)->_getITables())->getValue))();
        
    }
    
    // captured environment
    x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > e;
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        buf.write(this->e);
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > that_e = buf.read<x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >();
        x10aux::ref<x10_util_DistributedRail__closure__13<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__13<FMGL(T) > >()) x10_util_DistributedRail__closure__13<FMGL(T) >(that_e);
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__13(x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > e) : e(e) { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:124";
    }

};

template<class FMGL(T)> typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::template itable <x10_util_DistributedRail__closure__13<FMGL(T) > >x10_util_DistributedRail__closure__13<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__13<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__13<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__13<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >, &x10_util_DistributedRail__closure__13<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__13<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__13<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__13_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__12_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__12_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/Fun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__12 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::Fun_0_0<x10::util::Pair<x10aux::ref<x10::lang::Rail<FMGL(T) > >, x10_int> >::template itable <x10_util_DistributedRail__closure__12<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    x10::util::Pair<x10aux::ref<x10::lang::Rail<FMGL(T) > >, x10_int> apply() {
        
        //#line 114 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
        return x10::util::Pair_methods<x10aux::ref<x10::lang::Rail<FMGL(T) > >, x10_int>::_make(x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::apply(handle),
                                                                                                ((x10_int)0));
        
    }
    
    // captured environment
    x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Rail<FMGL(T) > > > handle;
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        buf.write(this->handle);
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Rail<FMGL(T) > > > that_handle = buf.read<x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >();
        x10aux::ref<x10_util_DistributedRail__closure__12<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__12<FMGL(T) > >()) x10_util_DistributedRail__closure__12<FMGL(T) >(that_handle);
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__12(x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Rail<FMGL(T) > > > handle) : handle(handle) { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::Fun_0_0<x10::util::Pair<x10aux::ref<x10::lang::Rail<FMGL(T) > >, x10_int> > >(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::Fun_0_0<x10::util::Pair<x10aux::ref<x10::lang::Rail<FMGL(T) > >, x10_int> > >(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:114";
    }

};

template<class FMGL(T)> typename x10::lang::Fun_0_0<x10::util::Pair<x10aux::ref<x10::lang::Rail<FMGL(T) > >, x10_int> >::template itable <x10_util_DistributedRail__closure__12<FMGL(T) > >x10_util_DistributedRail__closure__12<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__12<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__12<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__12<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::Fun_0_0<x10::util::Pair<x10aux::ref<x10::lang::Rail<FMGL(T) > >, x10_int> > >, &x10_util_DistributedRail__closure__12<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__12<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__12<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__12_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__11_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__11_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/VoidFun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__11 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::VoidFun_0_0::template itable <x10_util_DistributedRail__closure__11<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    void apply() {
        
        //#line 106 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
        x10aux::ref<x10::lang::Rail<FMGL(T) > > master = x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::apply(data_);
        
        //#line 107 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Try_c
        try {
        try {
            
            //#line 107 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
            x10::lang::Runtime::lock();
            {
                
                //#line 107 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.For_c
                {
                    x10_int i;
                    for (
                         //#line 107 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
                         i = ((x10_int)0); ((i) < (x10aux::nullCheck(master)->
                                                     FMGL(length))); 
                                                                     //#line 107 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                                                                     i = ((x10_int) ((i) + (((x10_int)1)))))
                    {
                        
                        //#line 108 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                        (master)->set((((x10::lang::Reference*)(((x10aux::ref<x10::lang::Reference>)x10aux::placeCheck(x10aux::nullCheck(op))).operator->()))->*(x10aux::findITable<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> >(((x10aux::ref<x10::lang::Reference>)op)->_getITables())->apply))(
                          (master)->apply(i),
                          (lrail)->apply(i)), i);
                    }
                }
                
            }
        }
        catch (x10aux::__ref& __ref__1137) {
            throw;
        }
        } catch (...) {
            {
                
                //#line 107 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                x10::lang::Runtime::release();
            }
            throw;
        }
        {
            
            //#line 107 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
            x10::lang::Runtime::release();
        }
    }
    
    // captured environment
    x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Rail<FMGL(T) > > > data_;
    x10aux::ref<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> > op;
    x10aux::ref<x10::lang::ValRail<FMGL(T) > > lrail;
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        buf.write(this->data_);
        buf.write(this->op);
        buf.write(this->lrail);
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Rail<FMGL(T) > > > that_data_ = buf.read<x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >();
        x10aux::ref<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> > that_op = buf.read<x10aux::ref<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> > >();
        x10aux::ref<x10::lang::ValRail<FMGL(T) > > that_lrail = buf.read<x10aux::ref<x10::lang::ValRail<FMGL(T) > > >();
        x10aux::ref<x10_util_DistributedRail__closure__11<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__11<FMGL(T) > >()) x10_util_DistributedRail__closure__11<FMGL(T) >(that_data_, that_op, that_lrail);
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__11(x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Rail<FMGL(T) > > > data_, x10aux::ref<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> > op, x10aux::ref<x10::lang::ValRail<FMGL(T) > > lrail) : data_(data_), op(op), lrail(lrail) { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::VoidFun_0_0>(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::VoidFun_0_0>(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:105-110";
    }

};

template<class FMGL(T)> typename x10::lang::VoidFun_0_0::template itable <x10_util_DistributedRail__closure__11<FMGL(T) > >x10_util_DistributedRail__closure__11<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__11<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__11<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__11<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::VoidFun_0_0>, &x10_util_DistributedRail__closure__11<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__11<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__11<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__11_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__10_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__10_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/Fun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__10 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::Fun_0_0<FMGL(T)>::template itable <x10_util_DistributedRail__closure__10<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    FMGL(T) apply() {
        
        //#line 93 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
        return (r)->apply(i0);
        
    }
    
    // captured environment
    x10aux::ref<x10::lang::Rail<FMGL(T) > > r;
    x10_int i0;
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        buf.write(this->r);
        buf.write(this->i0);
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10aux::ref<x10::lang::Rail<FMGL(T) > > that_r = buf.read<x10aux::ref<x10::lang::Rail<FMGL(T) > > >();
        x10_int that_i0 = buf.read<x10_int>();
        x10aux::ref<x10_util_DistributedRail__closure__10<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__10<FMGL(T) > >()) x10_util_DistributedRail__closure__10<FMGL(T) >(that_r, that_i0);
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__10(x10aux::ref<x10::lang::Rail<FMGL(T) > > r, x10_int i0) : r(r), i0(i0) { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::Fun_0_0<FMGL(T)> >(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::Fun_0_0<FMGL(T)> >(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:93";
    }

};

template<class FMGL(T)> typename x10::lang::Fun_0_0<FMGL(T)>::template itable <x10_util_DistributedRail__closure__10<FMGL(T) > >x10_util_DistributedRail__closure__10<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__10<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__10<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__10<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::Fun_0_0<FMGL(T)> >, &x10_util_DistributedRail__closure__10<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__10<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__10<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__10_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__9_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__9_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/VoidFun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__9 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::VoidFun_0_0::template itable <x10_util_DistributedRail__closure__9<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    void apply() {
        
        //#line 87 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Try_c
        try {
        try {
            
            //#line 87 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
            x10::lang::Runtime::startFinish();
            {
                
                //#line 87 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                x10::lang::Rail__NativeRep::copyTo(r,((x10_int)0),master,((x10_int)0),x10aux::nullCheck(r)->
                                                                                        FMGL(length));
            }
        }
        catch (x10aux::__ref& __ref__1135) {
            x10aux::ref<x10::lang::Throwable>& __exc__ref__1135 = (x10aux::ref<x10::lang::Throwable>&)__ref__1135;
            if (x10aux::instanceof<x10aux::ref<x10::lang::Throwable> >(__exc__ref__1135)) {
                x10aux::ref<x10::lang::Throwable> __desugarer__var__74__ =
                  static_cast<x10aux::ref<x10::lang::Throwable> >(__exc__ref__1135);
                {
                    
                    //#line 87 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                    x10::lang::Runtime::pushException(
                      __desugarer__var__74__);
                }
            } else
            throw;
        }
        } catch (...) {
            {
                
                //#line 87 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                x10::lang::Runtime::stopFinish();
            }
            throw;
        }
        {
            
            //#line 87 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
            x10::lang::Runtime::stopFinish();
        }
    }
    
    // captured environment
    x10aux::ref<x10::lang::Rail<FMGL(T) > > r;
    x10aux::ref<x10::lang::Rail<FMGL(T) > > master;
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        buf.write(this->r);
        buf.write(this->master);
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10aux::ref<x10::lang::Rail<FMGL(T) > > that_r = buf.read<x10aux::ref<x10::lang::Rail<FMGL(T) > > >();
        x10aux::ref<x10::lang::Rail<FMGL(T) > > that_master = buf.read<x10aux::ref<x10::lang::Rail<FMGL(T) > > >();
        x10aux::ref<x10_util_DistributedRail__closure__9<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__9<FMGL(T) > >()) x10_util_DistributedRail__closure__9<FMGL(T) >(that_r, that_master);
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__9(x10aux::ref<x10::lang::Rail<FMGL(T) > > r, x10aux::ref<x10::lang::Rail<FMGL(T) > > master) : r(r), master(master) { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::VoidFun_0_0>(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::VoidFun_0_0>(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:87";
    }

};

template<class FMGL(T)> typename x10::lang::VoidFun_0_0::template itable <x10_util_DistributedRail__closure__9<FMGL(T) > >x10_util_DistributedRail__closure__9<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__9<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__9<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__9<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::VoidFun_0_0>, &x10_util_DistributedRail__closure__9<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__9<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__9<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__9_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__8_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__8_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/Fun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__8 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::template itable <x10_util_DistributedRail__closure__8<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    x10aux::ref<x10::lang::Rail<FMGL(T) > > apply() {
        
        //#line 84 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
        return (((x10::lang::Reference*)(((x10aux::ref<x10::lang::Reference>)x10aux::nullCheck(e)).operator->()))->*(x10aux::findITable<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(((x10aux::ref<x10::lang::Reference>)e)->_getITables())->getValue))();
        
    }
    
    // captured environment
    x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > e;
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        buf.write(this->e);
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > that_e = buf.read<x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >();
        x10aux::ref<x10_util_DistributedRail__closure__8<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__8<FMGL(T) > >()) x10_util_DistributedRail__closure__8<FMGL(T) >(that_e);
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__8(x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > e) : e(e) { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:84";
    }

};

template<class FMGL(T)> typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::template itable <x10_util_DistributedRail__closure__8<FMGL(T) > >x10_util_DistributedRail__closure__8<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__8<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__8<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__8<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >, &x10_util_DistributedRail__closure__8<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__8<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__8<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__8_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__7_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__7_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/Fun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__7 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Iterator<FMGL(T)> > >::template itable <x10_util_DistributedRail__closure__7<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    x10aux::ref<x10::lang::Iterator<FMGL(T)> > apply() {
        
        //#line 77 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
        return (t)->iterator();
        
    }
    
    // captured environment
    x10aux::ref<x10::lang::Rail<FMGL(T) > > t;
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        buf.write(this->t);
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10aux::ref<x10::lang::Rail<FMGL(T) > > that_t = buf.read<x10aux::ref<x10::lang::Rail<FMGL(T) > > >();
        x10aux::ref<x10_util_DistributedRail__closure__7<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__7<FMGL(T) > >()) x10_util_DistributedRail__closure__7<FMGL(T) >(that_t);
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__7(x10aux::ref<x10::lang::Rail<FMGL(T) > > t) : t(t) { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Iterator<FMGL(T)> > > >(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Iterator<FMGL(T)> > > >(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:77";
    }

};

template<class FMGL(T)> typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Iterator<FMGL(T)> > >::template itable <x10_util_DistributedRail__closure__7<FMGL(T) > >x10_util_DistributedRail__closure__7<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__7<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__7<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__7<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Iterator<FMGL(T)> > > >, &x10_util_DistributedRail__closure__7<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__7<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__7<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__7_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__6_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__6_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/VoidFun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__6 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::VoidFun_0_0::template itable <x10_util_DistributedRail__closure__6<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    void apply() {
        
        //#line 70 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        (t)->set(v, i);
    }
    
    // captured environment
    x10aux::ref<x10::lang::Rail<FMGL(T) > > t;
    FMGL(T) v;
    x10_int i;
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        buf.write(this->t);
        buf.write(this->v);
        buf.write(this->i);
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10aux::ref<x10::lang::Rail<FMGL(T) > > that_t = buf.read<x10aux::ref<x10::lang::Rail<FMGL(T) > > >();
        FMGL(T) that_v = buf.read<FMGL(T)>();
        x10_int that_i = buf.read<x10_int>();
        x10aux::ref<x10_util_DistributedRail__closure__6<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__6<FMGL(T) > >()) x10_util_DistributedRail__closure__6<FMGL(T) >(that_t, that_v, that_i);
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__6(x10aux::ref<x10::lang::Rail<FMGL(T) > > t, FMGL(T) v, x10_int i) : t(t), v(v), i(i) { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::VoidFun_0_0>(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::VoidFun_0_0>(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:70";
    }

};

template<class FMGL(T)> typename x10::lang::VoidFun_0_0::template itable <x10_util_DistributedRail__closure__6<FMGL(T) > >x10_util_DistributedRail__closure__6<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__6<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__6<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__6<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::VoidFun_0_0>, &x10_util_DistributedRail__closure__6<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__6<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__6<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__6_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__5_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__5_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/Fun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__5 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::template itable <x10_util_DistributedRail__closure__5<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    x10aux::ref<x10::lang::Rail<FMGL(T) > > apply() {
        
        //#line 42 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
        return x10::lang::Rail<void>::make<FMGL(T) >(len, x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_1<x10_int, FMGL(T)> > >(vr));
        
    }
    
    // captured environment
    x10_int len;
    x10aux::ref<x10::lang::ValRail<FMGL(T) > > vr;
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        buf.write(this->len);
        buf.write(this->vr);
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10_int that_len = buf.read<x10_int>();
        x10aux::ref<x10::lang::ValRail<FMGL(T) > > that_vr = buf.read<x10aux::ref<x10::lang::ValRail<FMGL(T) > > >();
        x10aux::ref<x10_util_DistributedRail__closure__5<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__5<FMGL(T) > >()) x10_util_DistributedRail__closure__5<FMGL(T) >(that_len, that_vr);
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__5(x10_int len, x10aux::ref<x10::lang::ValRail<FMGL(T) > > vr) : len(len), vr(vr) { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:42";
    }

};

template<class FMGL(T)> typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::template itable <x10_util_DistributedRail__closure__5<FMGL(T) > >x10_util_DistributedRail__closure__5<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__5<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__5<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__5<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >, &x10_util_DistributedRail__closure__5<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__5<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__5<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__5_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__4_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__4_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/Fun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__4 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > >::template itable <x10_util_DistributedRail__closure__4<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    x10aux::ref<x10::lang::Cell<x10_boolean> > apply() {
        
        //#line 30 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
        return x10::lang::Cell<x10_boolean>::_make(false);
        
    }
    
    // captured environment
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10aux::ref<x10_util_DistributedRail__closure__4<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__4<FMGL(T) > >()) x10_util_DistributedRail__closure__4<FMGL(T) >();
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__4() { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > > >(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > > >(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:30";
    }

};

template<class FMGL(T)> typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > >::template itable <x10_util_DistributedRail__closure__4<FMGL(T) > >x10_util_DistributedRail__closure__4<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__4<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__4<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__4<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > > >, &x10_util_DistributedRail__closure__4<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__4<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__4<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__4_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__3_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__3_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/Fun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__3 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >::template itable <x10_util_DistributedRail__closure__3<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > apply() {
        
        //#line 26 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
        return x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > >::_make();
        
    }
    
    // captured environment
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10aux::ref<x10_util_DistributedRail__closure__3<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__3<FMGL(T) > >()) x10_util_DistributedRail__closure__3<FMGL(T) >();
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__3() { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:26";
    }

};

template<class FMGL(T)> typename x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >::template itable <x10_util_DistributedRail__closure__3<FMGL(T) > >x10_util_DistributedRail__closure__3<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__3<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__3<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__3<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >, &x10_util_DistributedRail__closure__3<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__3<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__3<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__3_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__2_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__2_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/Fun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__2 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::template itable <x10_util_DistributedRail__closure__2<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    x10aux::ref<x10::lang::Rail<FMGL(T) > > apply() {
        
        //#line 34 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
        return x10::lang::Rail<void>::make<FMGL(T) >(len, x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_1<x10_int, FMGL(T)> > >(vr));
        
    }
    
    // captured environment
    x10_int len;
    x10aux::ref<x10::lang::ValRail<FMGL(T) > > vr;
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        buf.write(this->len);
        buf.write(this->vr);
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10_int that_len = buf.read<x10_int>();
        x10aux::ref<x10::lang::ValRail<FMGL(T) > > that_vr = buf.read<x10aux::ref<x10::lang::ValRail<FMGL(T) > > >();
        x10aux::ref<x10_util_DistributedRail__closure__2<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__2<FMGL(T) > >()) x10_util_DistributedRail__closure__2<FMGL(T) >(that_len, that_vr);
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__2(x10_int len, x10aux::ref<x10::lang::ValRail<FMGL(T) > > vr) : len(len), vr(vr) { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:34";
    }

};

template<class FMGL(T)> typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::template itable <x10_util_DistributedRail__closure__2<FMGL(T) > >x10_util_DistributedRail__closure__2<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__2<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__2<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__2<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >, &x10_util_DistributedRail__closure__2<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__2<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__2<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__2_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__1_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__1_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/Fun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__1 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > >::template itable <x10_util_DistributedRail__closure__1<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    x10aux::ref<x10::lang::Cell<x10_boolean> > apply() {
        
        //#line 30 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
        return x10::lang::Cell<x10_boolean>::_make(false);
        
    }
    
    // captured environment
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10aux::ref<x10_util_DistributedRail__closure__1<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__1<FMGL(T) > >()) x10_util_DistributedRail__closure__1<FMGL(T) >();
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__1() { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > > >(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > > >(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:30";
    }

};

template<class FMGL(T)> typename x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > >::template itable <x10_util_DistributedRail__closure__1<FMGL(T) > >x10_util_DistributedRail__closure__1<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__1<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__1<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__1<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > > >, &x10_util_DistributedRail__closure__1<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__1<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__1<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__1_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__0_CLOSURE
#define X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__0_CLOSURE
#include <x10/lang/Closure.h>
#include <x10/lang/Fun_0_0.h>
template<class FMGL(T)> class x10_util_DistributedRail__closure__0 : public x10::lang::Closure {
    public:
    
    static typename x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >::template itable <x10_util_DistributedRail__closure__0<FMGL(T) > > _itable;
    static x10aux::itable_entry _itables[2];
    
    virtual x10aux::itable_entry* _getITables() { return _itables; }
    
    // closure body
    x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > apply() {
        
        //#line 26 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
        return x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > >::_make();
        
    }
    
    // captured environment
    
    x10aux::serialization_id_t _get_serialization_id() {
        return _serialization_id;
    }
    
    // TODO: handle serialization of ref fields correctly
    
    void _serialize_body(x10aux::serialization_buffer &buf) {
        
    }
    
    template<class __T> static x10aux::ref<__T> _deserialize(x10aux::deserialization_buffer &buf) {
        x10aux::ref<x10_util_DistributedRail__closure__0<FMGL(T) > > this_ = new (x10aux::alloc<x10_util_DistributedRail__closure__0<FMGL(T) > >()) x10_util_DistributedRail__closure__0<FMGL(T) >();
        buf.record_reference(this_); // TODO: avoid; closure
        return this_;
    }
    
    x10_util_DistributedRail__closure__0() { }
    
    static const x10aux::serialization_id_t _serialization_id;
    
    static const x10aux::RuntimeType* getRTT() { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(); }
    virtual const x10aux::RuntimeType *_type() const { return x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(); }
    
    x10aux::ref<x10::lang::String> toString() {
        return x10::lang::String::Lit(this->toNativeString());
    }
    
    const char* toNativeString() {
        return "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10:26";
    }

};

template<class FMGL(T)> typename x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >::template itable <x10_util_DistributedRail__closure__0<FMGL(T) > >x10_util_DistributedRail__closure__0<FMGL(T) >::_itable(&x10_util_DistributedRail__closure__0<FMGL(T) >::apply, &x10::lang::Reference::at, &x10::lang::Reference::at, &x10::lang::Reference::equals, &x10::lang::Closure::hashCode, &x10::lang::Reference::home, &x10_util_DistributedRail__closure__0<FMGL(T) >::toString, &x10::lang::Closure::typeName);template<class FMGL(T)>
x10aux::itable_entry x10_util_DistributedRail__closure__0<FMGL(T) >::_itables[2] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >, &x10_util_DistributedRail__closure__0<FMGL(T) >::_itable),x10aux::itable_entry(NULL, NULL)};

template<class FMGL(T)>
const x10aux::serialization_id_t x10_util_DistributedRail__closure__0<FMGL(T) >::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10_util_DistributedRail__closure__0<FMGL(T) >::template _deserialize<x10::lang::Object>);

#endif // X10_UTIL_DISTRIBUTEDRAIL__CLOSURE__0_CLOSURE
#ifndef X10_UTIL_DISTRIBUTEDRAIL_H_GENERICS
#define X10_UTIL_DISTRIBUTEDRAIL_H_GENERICS
template<class FMGL(T)> template<class __T> x10aux::ref<__T> x10::util::DistributedRail<FMGL(T)>::_deserializer(x10aux::deserialization_buffer& buf) {
    x10aux::ref<x10::util::DistributedRail<FMGL(T)> > this_ = new (x10aux::alloc_remote<x10::util::DistributedRail<FMGL(T)> >()) x10::util::DistributedRail<FMGL(T)>();
    buf.record_reference(this_);
    this_->_deserialize_body(buf);
    return this_;
}

template<class FMGL(T)> template<class __T> x10aux::ref<__T> x10::util::DistributedRail<FMGL(T)>::_deserialize(x10aux::deserialization_buffer& buf) {
    x10::lang::Object::_reference_state rr = x10::lang::Object::_deserialize_reference_state(buf);
    x10aux::ref<x10::util::DistributedRail<FMGL(T)> > this_;
    if (rr.ref != 0) {
        this_ = x10::util::DistributedRail<FMGL(T)>::template _deserializer<x10::util::DistributedRail<FMGL(T)> >(buf);
    }
    return x10::lang::Object::_finalize_reference<__T>(this_, rr, buf);
}

#endif // X10_UTIL_DISTRIBUTEDRAIL_H_GENERICS
#ifndef X10_UTIL_DISTRIBUTEDRAIL_H_IMPLEMENTATION
#define X10_UTIL_DISTRIBUTEDRAIL_H_IMPLEMENTATION
#include <x10/util/DistributedRail.h>


#include "x10/util/DistributedRail.inc"

template<class FMGL(T)> typename x10::lang::Settable<x10_int, FMGL(T)>::template itable<x10::util::DistributedRail<FMGL(T)> >  x10::util::DistributedRail<FMGL(T)>::_itable_0(&x10::util::DistributedRail<FMGL(T)>::at, &x10::util::DistributedRail<FMGL(T)>::at, &x10::util::DistributedRail<FMGL(T)>::equals, &x10::util::DistributedRail<FMGL(T)>::hashCode, &x10::util::DistributedRail<FMGL(T)>::home, &x10::util::DistributedRail<FMGL(T)>::set, &x10::util::DistributedRail<FMGL(T)>::toString, &x10::util::DistributedRail<FMGL(T)>::typeName);
template<class FMGL(T)> x10::lang::Any::itable<x10::util::DistributedRail<FMGL(T)> >  x10::util::DistributedRail<FMGL(T)>::_itable_1(&x10::util::DistributedRail<FMGL(T)>::at, &x10::util::DistributedRail<FMGL(T)>::at, &x10::util::DistributedRail<FMGL(T)>::equals, &x10::util::DistributedRail<FMGL(T)>::hashCode, &x10::util::DistributedRail<FMGL(T)>::home, &x10::util::DistributedRail<FMGL(T)>::toString, &x10::util::DistributedRail<FMGL(T)>::typeName);
template<class FMGL(T)> typename x10::lang::Iterable<FMGL(T)>::template itable<x10::util::DistributedRail<FMGL(T)> >  x10::util::DistributedRail<FMGL(T)>::_itable_2(&x10::util::DistributedRail<FMGL(T)>::at, &x10::util::DistributedRail<FMGL(T)>::at, &x10::util::DistributedRail<FMGL(T)>::equals, &x10::util::DistributedRail<FMGL(T)>::hashCode, &x10::util::DistributedRail<FMGL(T)>::home, &x10::util::DistributedRail<FMGL(T)>::iterator, &x10::util::DistributedRail<FMGL(T)>::toString, &x10::util::DistributedRail<FMGL(T)>::typeName);
template<class FMGL(T)> x10aux::itable_entry x10::util::DistributedRail<FMGL(T)>::_itables[4] = {x10aux::itable_entry(&x10aux::getRTT<x10::lang::Settable<x10_int, FMGL(T)> >, &_itable_0), x10aux::itable_entry(&x10aux::getRTT<x10::lang::Any>, &_itable_1), x10aux::itable_entry(&x10aux::getRTT<x10::lang::Iterable<FMGL(T)> >, &_itable_2), x10aux::itable_entry(NULL, (void*)x10aux::getRTT<x10::util::DistributedRail<FMGL(T)> >())};
template<class FMGL(T)> void x10::util::DistributedRail<FMGL(T)>::_instance_init() {
    _I_("Doing initialisation for class: x10::util::DistributedRail<FMGL(T)>");
    
}


//#line 21 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10FieldDecl_c

//#line 22 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10FieldDecl_c

//#line 24 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10FieldDecl_c

//#line 27 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10FieldDecl_c

//#line 28 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10FieldDecl_c

//#line 30 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10FieldDecl_c

//#line 32 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10ConstructorDecl_c
template<class FMGL(T)> void x10::util::DistributedRail<FMGL(T)>::_constructor(
                          x10_int len,
                          x10aux::ref<x10::lang::ValRail<FMGL(T) > > init)
{
    this->x10::lang::Object::_constructor();
    
    //#line 25 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
      FMGL(localRails) =
      x10::lang::PlaceLocalHandle_methods<void>::make<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >(
        x10::array::Dist::makeUnique(),
        x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > > >(x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(x10aux::ref<x10_util_DistributedRail__closure__0<FMGL(T) > >(new (x10aux::alloc<x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(sizeof(x10_util_DistributedRail__closure__0<FMGL(T)>)))x10_util_DistributedRail__closure__0<FMGL(T)>()))));
    
    //#line 30 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
      FMGL(done) =
      x10::lang::PlaceLocalHandle_methods<void>::make<x10aux::ref<x10::lang::Cell<x10_boolean> > >(
        x10::array::Dist::makeUnique(),
        x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > > > >(x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > > >(x10aux::ref<x10_util_DistributedRail__closure__1<FMGL(T) > >(new (x10aux::alloc<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > > >(sizeof(x10_util_DistributedRail__closure__1<FMGL(T)>)))x10_util_DistributedRail__closure__1<FMGL(T)>()))));
    
    //#line 33 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
    x10aux::ref<x10::lang::ValRail<FMGL(T) > > vr =
      x10::lang::ValRail<FMGL(T) >::make(len, x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_1<x10_int, FMGL(T)> > >(init));
    
    //#line 34 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
      FMGL(data) =
      x10::lang::PlaceLocalHandle_methods<void>::make<x10aux::ref<x10::lang::Rail<FMGL(T) > > >(
        x10::array::Dist::makeUnique(),
        x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >(x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(x10aux::ref<x10_util_DistributedRail__closure__2<FMGL(T) > >(new (x10aux::alloc<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(sizeof(x10_util_DistributedRail__closure__2<FMGL(T)>)))x10_util_DistributedRail__closure__2<FMGL(T)>(len, vr)))));
    
    //#line 35 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
      FMGL(firstPlace) =
      x10::lang::Place_methods::_make(x10aux::here);
    
    //#line 36 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
      FMGL(original) =
      vr;
    
    //#line 37 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
      FMGL(original_len) =
      len;
    
}
template<class FMGL(T)>
x10aux::ref<x10::util::DistributedRail<FMGL(T)> > x10::util::DistributedRail<FMGL(T)>::_make(
  x10_int len,
  x10aux::ref<x10::lang::ValRail<FMGL(T) > > init)
{
    x10aux::ref<x10::util::DistributedRail<FMGL(T)> > this_ = new (memset(x10aux::alloc<x10::util::DistributedRail<FMGL(T)> >(), 0, sizeof(x10::util::DistributedRail<FMGL(T)>))) x10::util::DistributedRail<FMGL(T)>();
    this_->_constructor(len,
    init);
    return this_;
}



//#line 40 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10ConstructorDecl_c
template<class FMGL(T)> void x10::util::DistributedRail<FMGL(T)>::_constructor(
                          x10_int len,
                          x10aux::ref<x10::lang::Fun_0_1<x10_int, FMGL(T)> > init)
{
    this->x10::lang::Object::_constructor();
    
    //#line 25 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
      FMGL(localRails) =
      x10::lang::PlaceLocalHandle_methods<void>::make<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >(
        x10::array::Dist::makeUnique(),
        x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > > >(x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(x10aux::ref<x10_util_DistributedRail__closure__3<FMGL(T) > >(new (x10aux::alloc<x10::lang::Fun_0_0<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(sizeof(x10_util_DistributedRail__closure__3<FMGL(T)>)))x10_util_DistributedRail__closure__3<FMGL(T)>()))));
    
    //#line 30 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
      FMGL(done) =
      x10::lang::PlaceLocalHandle_methods<void>::make<x10aux::ref<x10::lang::Cell<x10_boolean> > >(
        x10::array::Dist::makeUnique(),
        x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > > > >(x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > > >(x10aux::ref<x10_util_DistributedRail__closure__4<FMGL(T) > >(new (x10aux::alloc<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Cell<x10_boolean> > > >(sizeof(x10_util_DistributedRail__closure__4<FMGL(T)>)))x10_util_DistributedRail__closure__4<FMGL(T)>()))));
    
    //#line 41 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
    x10aux::ref<x10::lang::ValRail<FMGL(T) > > vr =
      x10::lang::ValRail<FMGL(T) >::make(len, init);
    
    //#line 42 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
      FMGL(data) =
      x10::lang::PlaceLocalHandle_methods<void>::make<x10aux::ref<x10::lang::Rail<FMGL(T) > > >(
        x10::array::Dist::makeUnique(),
        x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >(x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(x10aux::ref<x10_util_DistributedRail__closure__5<FMGL(T) > >(new (x10aux::alloc<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(sizeof(x10_util_DistributedRail__closure__5<FMGL(T)>)))x10_util_DistributedRail__closure__5<FMGL(T)>(len, vr)))));
    
    //#line 43 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
      FMGL(firstPlace) =
      x10::lang::Place_methods::_make(x10aux::here);
    
    //#line 44 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
      FMGL(original) =
      vr;
    
    //#line 45 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
      FMGL(original_len) =
      len;
    
}
template<class FMGL(T)>
x10aux::ref<x10::util::DistributedRail<FMGL(T)> > x10::util::DistributedRail<FMGL(T)>::_make(
  x10_int len,
  x10aux::ref<x10::lang::Fun_0_1<x10_int, FMGL(T)> > init)
{
    x10aux::ref<x10::util::DistributedRail<FMGL(T)> > this_ = new (memset(x10aux::alloc<x10::util::DistributedRail<FMGL(T)> >(), 0, sizeof(x10::util::DistributedRail<FMGL(T)>))) x10::util::DistributedRail<FMGL(T)>();
    this_->_constructor(len,
    init);
    return this_;
}



//#line 48 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10MethodDecl_c

//#line 50 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10MethodDecl_c
template<class FMGL(T)> x10aux::ref<x10::lang::Rail<FMGL(T) > >
  x10::util::DistributedRail<FMGL(T)>::apply(
  ) {
    
    //#line 51 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
    x10aux::ref<x10::lang::Activity> a = x10::lang::Runtime::activity();
    
    //#line 52 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
    x10aux::ref<x10::lang::Rail<FMGL(T) > > r =
      (__extension__ ({
        x10aux::ref<x10::lang::Rail<FMGL(T) > > __desugarer__var__73__ =
          x10aux::nullCheck(x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >::apply(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                                                                                                                        FMGL(localRails)))->getOrElse(
            a,
            x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Rail<FMGL(T) > > >(x10aux::null));
        
        //#line 52 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
        x10aux::ref<x10::lang::Rail<FMGL(T) > > __var1128__;
        
        //#line 52 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Labeled_c
        goto __ret2005; __ret2005: 
        //#line 52 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Do_c
        do
        {
        {
            
            //#line 52 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10If_c
            if ((!x10aux::struct_equals(__desugarer__var__73__,
                                        x10aux::null)) &&
                !((x10aux::struct_equals(x10::lang::Place_methods::place((__desugarer__var__73__)->location),
                                         x10::lang::Place_methods::_make(x10aux::here)))))
            {
                
                //#line 52 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Throw_c
                x10aux::throwException(x10aux::nullCheck(x10::lang::ClassCastException::_make(x10::lang::String::Lit("x10.lang.Rail[T]{self.home==here}"))));
            }
            
            //#line 52 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
            __var1128__ =
              __desugarer__var__73__;
            
            //#line 52 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Branch_c
            goto __ret2005_end_;
        }
        goto __ret2005_next_; __ret2005_next_: ;
        }
        while (false);
        goto __ret2005_end_; __ret2005_end_: ;
        __var1128__;
    }))
    ;
    
    //#line 53 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10If_c
    if ((x10aux::struct_equals(r, x10aux::null)))
    {
        
        //#line 54 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
        x10aux::ref<x10::lang::Rail<FMGL(T) > > r_ =
          x10::lang::Rail<void>::make<FMGL(T) >(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                  FMGL(original_len), x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_1<x10_int, FMGL(T)> > >(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                                                                                          FMGL(original)));
        
        //#line 55 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        x10aux::nullCheck(x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >::apply(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                                                                                                                      FMGL(localRails)))->put(
          a,
          r_);
        
        //#line 56 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
        return r_;
        
    }
    
    //#line 58 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
    return r;
    
}

//#line 61 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10MethodDecl_c
template<class FMGL(T)> x10aux::ref<x10::lang::Rail<FMGL(T) > >
  x10::util::DistributedRail<FMGL(T)>::get(
  ) {
    
    //#line 61 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
    return x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::apply(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                                  FMGL(data));
    
}

//#line 63 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10MethodDecl_c
template<class FMGL(T)> void x10::util::DistributedRail<FMGL(T)>::drop(
  ) {
    
    //#line 63 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    x10aux::nullCheck(x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >::apply(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                                                                                                                  FMGL(localRails)))->remove(
      x10::lang::Runtime::activity());
}

//#line 65 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10MethodDecl_c
template<class FMGL(T)> FMGL(T) x10::util::DistributedRail<FMGL(T)>::apply(
  x10_int i) {
    
    //#line 65 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
    return (((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->x10::util::DistributedRail<FMGL(T)>::apply())->apply(i);
    
}

//#line 67 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10MethodDecl_c
template<class FMGL(T)> FMGL(T) x10::util::DistributedRail<FMGL(T)>::set(
  FMGL(T) v,
  x10_int i) {
    
    //#line 68 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
    x10aux::ref<x10::lang::Rail<FMGL(T) > > t =
      ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->x10::util::DistributedRail<FMGL(T)>::apply();
    
    //#line 69 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    x10::lang::Runtime::runAt(x10::lang::Place_methods::place(x10aux::get_location(t)),
                              x10aux::class_cast_unchecked<x10aux::ref<x10::lang::VoidFun_0_0> >(x10aux::ref<x10::lang::VoidFun_0_0>(x10aux::ref<x10_util_DistributedRail__closure__6<FMGL(T) > >(new (x10aux::alloc<x10::lang::VoidFun_0_0>(sizeof(x10_util_DistributedRail__closure__6<FMGL(T)>)))x10_util_DistributedRail__closure__6<FMGL(T)>(t, v, i)))));
    
    //#line 71 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
    return v;
    
}

//#line 74 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10MethodDecl_c
template<class FMGL(T)> x10aux::ref<x10::lang::Iterator<FMGL(T)> >
  x10::util::DistributedRail<FMGL(T)>::iterator(
  ) {
    
    //#line 75 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
    x10aux::ref<x10::lang::Rail<FMGL(T) > > t =
      ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->x10::util::DistributedRail<FMGL(T)>::apply();
    
    //#line 76 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
    return x10::lang::Runtime::template evalAt<x10aux::ref<x10::lang::Iterator<FMGL(T)> > >(
             x10::lang::Place_methods::place(x10aux::get_location(t)),
             x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Iterator<FMGL(T)> > > > >(x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Iterator<FMGL(T)> > > >(x10aux::ref<x10_util_DistributedRail__closure__7<FMGL(T) > >(new (x10aux::alloc<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Iterator<FMGL(T)> > > >(sizeof(x10_util_DistributedRail__closure__7<FMGL(T)>)))x10_util_DistributedRail__closure__7<FMGL(T)>(t)))));
    
}

//#line 80 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10MethodDecl_c
template<class FMGL(T)> void x10::util::DistributedRail<FMGL(T)>::reduceLocal(
  x10aux::ref<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> > op) {
    
    //#line 81 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
    x10aux::ref<x10::lang::Rail<FMGL(T) > > master =
      x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::apply(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                             FMGL(data));
    
    //#line 82 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
    x10_boolean first = true;
    
    //#line 83 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.For_c
    {
        x10aux::ref<x10::lang::Iterator<x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > > e1833;
        for (
             //#line 83 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
             e1833 = (__extension__ ({ x10aux::ref<x10::lang::Reference> _ = x10aux::nullCheck(x10aux::nullCheck(x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >::apply(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                                                                                                                                                                                                             FMGL(localRails)))->entries());
                     (((x10::lang::Reference*)(_.operator->()))->*(x10aux::findITable<x10::util::Set<x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(_->_getITables())->iterator))(); }));
             (((x10::lang::Reference*)(((x10aux::ref<x10::lang::Reference>)x10aux::placeCheck(x10aux::nullCheck(e1833))).operator->()))->*(x10aux::findITable<x10::lang::Iterator<x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(((x10aux::ref<x10::lang::Reference>)e1833)->_getITables())->hasNext))();
             ) {
            
            //#line 83 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
            x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > e =
              (((x10::lang::Reference*)(((x10aux::ref<x10::lang::Reference>)x10aux::placeCheck(x10aux::nullCheck(e1833))).operator->()))->*(x10aux::findITable<x10::lang::Iterator<x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(((x10aux::ref<x10::lang::Reference>)e1833)->_getITables())->next))();
            
            //#line 84 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
            x10aux::ref<x10::lang::Rail<FMGL(T) > > r =
              x10::lang::Runtime::template evalAt<x10aux::ref<x10::lang::Rail<FMGL(T) > > >(
                x10::lang::Place_methods::place(x10aux::get_location(e)),
                x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >(x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(x10aux::ref<x10_util_DistributedRail__closure__8<FMGL(T) > >(new (x10aux::alloc<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(sizeof(x10_util_DistributedRail__closure__8<FMGL(T)>)))x10_util_DistributedRail__closure__8<FMGL(T)>(e)))));
            
            //#line 85 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10If_c
            if (first) {
                
                //#line 86 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                x10::lang::Runtime::runAt(
                  x10::lang::Place_methods::place(x10aux::get_location(r)),
                  x10aux::class_cast_unchecked<x10aux::ref<x10::lang::VoidFun_0_0> >(x10aux::ref<x10::lang::VoidFun_0_0>(x10aux::ref<x10_util_DistributedRail__closure__9<FMGL(T) > >(new (x10aux::alloc<x10::lang::VoidFun_0_0>(sizeof(x10_util_DistributedRail__closure__9<FMGL(T)>)))x10_util_DistributedRail__closure__9<FMGL(T)>(r, master)))));
                
                //#line 88 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                first = false;
            } else {
                
                //#line 91 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.For_c
                {
                    x10_int i;
                    for (
                         //#line 91 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
                         i = ((x10_int)0);
                         ((i) < (x10aux::nullCheck(master)->
                                   FMGL(length)));
                         
                         //#line 91 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                         i =
                           ((x10_int) ((i) + (((x10_int)1)))))
                    {
                        
                        //#line 92 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
                        x10_int i0 =
                          i;
                        
                        //#line 93 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                        (master)->set((((x10::lang::Reference*)(((x10aux::ref<x10::lang::Reference>)x10aux::placeCheck(x10aux::nullCheck(op))).operator->()))->*(x10aux::findITable<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> >(((x10aux::ref<x10::lang::Reference>)op)->_getITables())->apply))(
                          (master)->apply(i),
                          x10::lang::Runtime::template evalAt<FMGL(T) >(
                            x10::lang::Place_methods::place(x10aux::get_location(r)),
                            x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_0<FMGL(T)> > >(x10aux::ref<x10::lang::Fun_0_0<FMGL(T)> >(x10aux::ref<x10_util_DistributedRail__closure__10<FMGL(T) > >(new (x10aux::alloc<x10::lang::Fun_0_0<FMGL(T)> >(sizeof(x10_util_DistributedRail__closure__10<FMGL(T)>)))x10_util_DistributedRail__closure__10<FMGL(T)>(r, i0)))))), i);
                    }
                }
                
            }
            
        }
    }
    
}

//#line 99 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10MethodDecl_c
template<class FMGL(T)> void x10::util::DistributedRail<FMGL(T)>::reduceGlobal(
  x10aux::ref<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> > op) {
    
    //#line 100 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10If_c
    if ((!x10aux::struct_equals(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                  FMGL(firstPlace),
                                x10::lang::Place_methods::_make(x10aux::here))))
    {
        
        //#line 101 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
        x10aux::ref<x10::lang::Rail<FMGL(T) > > lrail_ =
          x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::apply(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                                 FMGL(data));
        {
            
            //#line 103 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
            x10aux::ref<x10::lang::ValRail<FMGL(T) > > lrail =
              x10::lang::ValRail<FMGL(T) >::make(lrail_);
            
            //#line 104 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
            x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Rail<FMGL(T) > > > data_ =
              ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                FMGL(data);
            
            //#line 105 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
            x10::lang::Runtime::runAt(
              ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                FMGL(firstPlace),
              x10aux::class_cast_unchecked<x10aux::ref<x10::lang::VoidFun_0_0> >(x10aux::ref<x10::lang::VoidFun_0_0>(x10aux::ref<x10_util_DistributedRail__closure__11<FMGL(T) > >(new (x10aux::alloc<x10::lang::VoidFun_0_0>(sizeof(x10_util_DistributedRail__closure__11<FMGL(T)>)))x10_util_DistributedRail__closure__11<FMGL(T)>(data_, op, lrail)))));
        }
        
        //#line 112 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        x10::lang::Runtime::next();
        
        //#line 113 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
        x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Rail<FMGL(T) > > > handle =
          ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
            FMGL(data);
        
        //#line 114 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Try_c
        try {
        try {
            
            //#line 114 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
            x10::lang::Runtime::startFinish();
            {
                
                //#line 114 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                x10::lang::Rail__NativeRep::copyFrom(lrail_,((x10_int)0),((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                           FMGL(firstPlace),x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_0<x10::util::Pair<x10aux::ref<x10::lang::Rail<FMGL(T) > >, x10_int> > > >(x10aux::ref<x10::lang::Fun_0_0<x10::util::Pair<x10aux::ref<x10::lang::Rail<FMGL(T) > >, x10_int> > >(x10aux::ref<x10_util_DistributedRail__closure__12<FMGL(T) > >(new (x10aux::alloc<x10::lang::Fun_0_0<x10::util::Pair<x10aux::ref<x10::lang::Rail<FMGL(T) > >, x10_int> > >(sizeof(x10_util_DistributedRail__closure__12<FMGL(T)>)))x10_util_DistributedRail__closure__12<FMGL(T)>(handle)))),x10aux::nullCheck(lrail_)->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   FMGL(length));
            }
        }
        catch (x10aux::__ref& __ref__1138) {
            x10aux::ref<x10::lang::Throwable>& __exc__ref__1138 = (x10aux::ref<x10::lang::Throwable>&)__ref__1138;
            if (x10aux::instanceof<x10aux::ref<x10::lang::Throwable> >(__exc__ref__1138)) {
                x10aux::ref<x10::lang::Throwable> __desugarer__var__75__ =
                  static_cast<x10aux::ref<x10::lang::Throwable> >(__exc__ref__1138);
                {
                    
                    //#line 114 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                    x10::lang::Runtime::pushException(
                      __desugarer__var__75__);
                }
            } else
            throw;
        }
        } catch (...) {
            {
                
                //#line 114 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                x10::lang::Runtime::stopFinish();
            }
            throw;
        }
        {
            
            //#line 114 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
            x10::lang::Runtime::stopFinish();
        }
    }
    else
    {
        
        //#line 116 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        x10::lang::Runtime::next();
    }
    
}

//#line 120 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10MethodDecl_c
template<class FMGL(T)> void x10::util::DistributedRail<FMGL(T)>::bcastLocal(
  x10aux::ref<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> > op) {
    
    //#line 121 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
    x10aux::ref<x10::lang::Rail<FMGL(T) > > master =
      x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::lang::Rail<FMGL(T) > > >::apply(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                             FMGL(data));
    
    //#line 122 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.For_c
    {
        x10aux::ref<x10::lang::Iterator<x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > > e1834;
        for (
             //#line 122 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
             e1834 = (__extension__ ({ x10aux::ref<x10::lang::Reference> _ = x10aux::nullCheck(x10aux::nullCheck(x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >::apply(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                                                                                                                                                                                                             FMGL(localRails)))->entries());
                     (((x10::lang::Reference*)(_.operator->()))->*(x10aux::findITable<x10::util::Set<x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(_->_getITables())->iterator))(); }));
             (((x10::lang::Reference*)(((x10aux::ref<x10::lang::Reference>)x10aux::placeCheck(x10aux::nullCheck(e1834))).operator->()))->*(x10aux::findITable<x10::lang::Iterator<x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(((x10aux::ref<x10::lang::Reference>)e1834)->_getITables())->hasNext))();
             ) {
            
            //#line 122 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
            x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > e =
              (((x10::lang::Reference*)(((x10aux::ref<x10::lang::Reference>)x10aux::placeCheck(x10aux::nullCheck(e1834))).operator->()))->*(x10aux::findITable<x10::lang::Iterator<x10aux::ref<x10::util::Map__Entry<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >(((x10aux::ref<x10::lang::Reference>)e1834)->_getITables())->next))();
            
            //#line 124 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
            x10aux::ref<x10::lang::Rail<FMGL(T) > > r =
              x10::lang::Runtime::template evalAt<x10aux::ref<x10::lang::Rail<FMGL(T) > > >(
                x10::lang::Place_methods::place(x10aux::get_location(e)),
                x10aux::class_cast_unchecked<x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > > >(x10aux::ref<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(x10aux::ref<x10_util_DistributedRail__closure__13<FMGL(T) > >(new (x10aux::alloc<x10::lang::Fun_0_0<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >(sizeof(x10_util_DistributedRail__closure__13<FMGL(T)>)))x10_util_DistributedRail__closure__13<FMGL(T)>(e)))));
            
            //#line 125 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Try_c
            try {
            try {
                
                //#line 125 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                x10::lang::Runtime::startFinish();
                {
                    
                    //#line 125 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                    x10::lang::Runtime::runAt(
                      x10::lang::Place_methods::place(x10aux::get_location(r)),
                      x10aux::class_cast_unchecked<x10aux::ref<x10::lang::VoidFun_0_0> >(x10aux::ref<x10::lang::VoidFun_0_0>(x10aux::ref<x10_util_DistributedRail__closure__14<FMGL(T) > >(new (x10aux::alloc<x10::lang::VoidFun_0_0>(sizeof(x10_util_DistributedRail__closure__14<FMGL(T)>)))x10_util_DistributedRail__closure__14<FMGL(T)>(r, master)))));
                }
            }
            catch (x10aux::__ref& __ref__1140) {
                x10aux::ref<x10::lang::Throwable>& __exc__ref__1140 = (x10aux::ref<x10::lang::Throwable>&)__ref__1140;
                if (x10aux::instanceof<x10aux::ref<x10::lang::Throwable> >(__exc__ref__1140)) {
                    x10aux::ref<x10::lang::Throwable> __desugarer__var__76__ =
                      static_cast<x10aux::ref<x10::lang::Throwable> >(__exc__ref__1140);
                    {
                        
                        //#line 125 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                        x10::lang::Runtime::pushException(
                          __desugarer__var__76__);
                    }
                } else
                throw;
            }
            } catch (...) {
                {
                    
                    //#line 125 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                    x10::lang::Runtime::stopFinish();
                }
                throw;
            }
            {
                
                //#line 125 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                x10::lang::Runtime::stopFinish();
            }
        }
    }
    
}

//#line 131 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10MethodDecl_c
template<class FMGL(T)> void x10::util::DistributedRail<FMGL(T)>::collectiveReduce(
  x10aux::ref<x10::lang::Fun_0_2<FMGL(T), FMGL(T), FMGL(T)> > op) {
    
    //#line 132 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10LocalDecl_c
    x10_boolean i_won = false;
    
    //#line 133 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Try_c
    try {
    try {
        
        //#line 133 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        x10::lang::Runtime::lock();
        {
            
            //#line 134 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10If_c
            if ((!(x10aux::nullCheck(x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::lang::Cell<x10_boolean> > >::apply(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                                                               FMGL(done)))->
                     FMGL(value)))) {
                
                //#line 135 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                i_won = true;
                
                //#line 136 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
                x10aux::nullCheck(x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::lang::Cell<x10_boolean> > >::apply(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                                                            FMGL(done)))->
                  FMGL(value) = true;
            }
            
        }
    }
    catch (x10aux::__ref& __ref__1142) {
        throw;
    }
    } catch (...) {
        {
            
            //#line 133 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
            x10::lang::Runtime::release();
        }
        throw;
    }
    {
        
        //#line 133 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        x10::lang::Runtime::release();
    }
    
    //#line 139 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    x10::lang::Runtime::next();
    
    //#line 140 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10If_c
    if (i_won) {
        
        //#line 142 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->x10::util::DistributedRail<FMGL(T)>::reduceLocal(
          op);
        
        //#line 143 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        x10::lang::Runtime::next();
        
        //#line 144 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->x10::util::DistributedRail<FMGL(T)>::reduceGlobal(
          op);
        
        //#line 145 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        ((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->x10::util::DistributedRail<FMGL(T)>::bcastLocal(
          op);
        
        //#line 146 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        x10aux::nullCheck(x10::lang::PlaceLocalHandle_methods<x10aux::ref<x10::lang::Cell<x10_boolean> > >::apply(((x10aux::ref<x10::util::DistributedRail<FMGL(T)> >)this)->
                                                                                                                    FMGL(done)))->
          FMGL(value) = false;
    } else {
        
        //#line 148 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        x10::lang::Runtime::next();
        
        //#line 149 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
        x10::lang::Runtime::next();
    }
    
    //#line 151 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": polyglot.ast.Eval_c
    x10::lang::Runtime::next();
}
template<class FMGL(T)> const x10aux::serialization_id_t x10::util::DistributedRail<FMGL(T)>::_serialization_id = 
    x10aux::DeserializationDispatcher::addDeserializer(x10::util::DistributedRail<FMGL(T)>::template _deserializer<x10::lang::Object>);

template<class FMGL(T)> void x10::util::DistributedRail<FMGL(T)>::_serialize(x10aux::ref<x10::util::DistributedRail<FMGL(T)> > this_,
                                                                             x10aux::serialization_buffer& buf) {
    _serialize_reference(this_, buf);
    if (this_ != x10aux::null) {
        this_->_serialize_body(buf);
    }
}

template<class FMGL(T)> void x10::util::DistributedRail<FMGL(T)>::_serialize_body(x10aux::serialization_buffer& buf) {
    x10::lang::Object::_serialize_body(buf);
    buf.write(this->FMGL(data));
    buf.write(this->FMGL(firstPlace));
    buf.write(this->FMGL(localRails));
    buf.write(this->FMGL(original));
    buf.write(this->FMGL(original_len));
    buf.write(this->FMGL(done));
    
}

template<class FMGL(T)> void x10::util::DistributedRail<FMGL(T)>::_deserialize_body(x10aux::deserialization_buffer& buf) {
    x10::lang::Object::_deserialize_body(buf);
    FMGL(data) = buf.read<x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Rail<FMGL(T) > > > >();
    FMGL(firstPlace) = buf.read<x10::lang::Place>();
    FMGL(localRails) = buf.read<x10::lang::PlaceLocalHandle<x10aux::ref<x10::util::HashMap<x10aux::ref<x10::lang::Activity>, x10aux::ref<x10::lang::Rail<FMGL(T) > > > > > >();
    FMGL(original) = buf.read<x10aux::ref<x10::lang::ValRail<FMGL(T) > > >();
    FMGL(original_len) = buf.read<x10_int>();
    FMGL(done) = buf.read<x10::lang::PlaceLocalHandle<x10aux::ref<x10::lang::Cell<x10_boolean> > > >();
}

template<class FMGL(T)> x10aux::RuntimeType x10::util::DistributedRail<FMGL(T)>::rtt;
template<class FMGL(T)> void x10::util::DistributedRail<FMGL(T)>::_initRTT() {
    const x10aux::RuntimeType *canonical = x10aux::getRTT<x10::util::DistributedRail<void> >();
    if (rtt.initStageOne(canonical)) return;
    const x10aux::RuntimeType* parents[3] = { x10aux::getRTT<x10::lang::Object>(), x10aux::getRTT<x10::lang::Settable<x10_int, FMGL(T)> >(), x10aux::getRTT<x10::lang::Iterable<FMGL(T)> >()};
    const x10aux::RuntimeType* params[1] = { x10aux::getRTT<FMGL(T)>()};
    x10aux::RuntimeType::Variance variances[1] = { x10aux::RuntimeType::invariant};
    const char *baseName = "x10.util.DistributedRail";
    rtt.initStageTwo(baseName, 3, parents, 1, params, variances);
}
template<class FMGL(S)> x10aux::ref<x10::lang::ValRail<FMGL(S) > >
  x10::util::DistributedRail<void>::__implicit_convert(x10aux::ref<x10::util::DistributedRail<FMGL(S)> > x)
{
    
    //#line 48 "/home/tux/workspace/x10.runtime/src-x10/x10/util/DistributedRail.x10": x10.ast.X10Return_c
    return x10::lang::ValRail<FMGL(S) >::make(x10aux::nullCheck(x)->x10::util::DistributedRail<FMGL(S)>::apply());
    
}
#endif // X10_UTIL_DISTRIBUTEDRAIL_H_IMPLEMENTATION
#endif // __X10_UTIL_DISTRIBUTEDRAIL_H_NODEPS
